#!/bin/sh
# Welcome to the End2End Integration Test of the Continuous Integration Pipeline
#
# This test employs - as far as possible - the same technologies and docker images
# as does the real CI pipeline running on Gitlab.
#
# The test depends on some secrets set as environment variables, due to the fact
# that docker images are uploaded to the registry and ec2 machines are created.


# change to the repository root folder via the scripts location
cd "$(dirname "$0")"/../..
. bin/includes/ci-test-base
########################################
set -x  # output all commands
set -o  pipefail
set -e  # exit on immediately on every error
set -u  # error on usage of undefined variables
########################################


export CI_COMMIT_REF_SLUG="${CI_COMMIT_REF_SLUG:-local-ci-test-smoke-tests}"
echo " CI_COMMIT_REF_SLUG= $CI_COMMIT_REF_SLUG"

## why so many files??
ci-exec-newman bin/ci-smoke-tests
