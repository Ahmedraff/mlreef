#################################################################################
# This is the MLReef configuration file.                                        #
# It contains the current configuration of  your data pipeline, model training, #
# or visualisation as well as the specific configurations.                      #
# Please refer to the documentation for information on how to edit this file    #
#################################################################################

job:
  image: docker:stable
  services:
    - docker:dind
  only:
    - master
  when: on_success
  script:
    - docker build -f ./Dockerfile -t $CI_REGISTRY/#{#CI_PROJECT_SLUG} --force-rm .
    - docker tag $CI_REGISTRY/#{#CI_PROJECT_SLUG} $CI_REGISTRY/#{#CI_PROJECT_SLUG}:latest
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
    - docker push $CI_REGISTRY/#{#CI_PROJECT_SLUG}:latest
