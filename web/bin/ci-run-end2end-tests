#!/bin/sh
# change to the repository root folder via the scripts location
cd "$(dirname "$0")"/../..
. bin/includes/detect-os
. bin/includes/ci-environment
########################################
set -x    # output all commands
set -e    # exit on immediately on every error
set -u    # error on usage of undefined variables
########################################

cd web

echo "Running end2end tests against $INSTANCE_HOST"

npm install --silent

# Instance host is used by the proxy as target for redirection
env INSTANCE_HOST="$INSTANCE_HOST" node src/__end2end-tests__/testProxy.js &

exec npm run end2end
